"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[888],{5965:function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});var a=s(4112),i=s(3740),r=s(3698),o=s(2938),n=s(3180),c=s(4414),l=s(3449),d=s(3064),u=s(9991),h=s(174),m=s(6930),g=s(5420),p=s(8983),f=s(7296),v=s(8924),b=s(9136),S=s(2756),_=s(5834),A=s(7150),y=s(1034),w=s(7112),k=function(){var e=this,t=e._self._c;return t(l.A,{attrs:{fluid:""}},[t(r.A,{staticClass:"mb-4"},[t("div",{staticClass:"profile-header"}),t(S.A,{attrs:{"no-gutters":""}},[t(c.A,{staticClass:"text-center profile-picture-section",attrs:{cols:"12",md:"3"}},[t("div",{staticClass:"profile-picture-container"},[t(a.A,{staticClass:"profile-avatar",attrs:{size:"150"}},[t(g.A,{attrs:{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ0hukRkoCl4HSLWAfbr5mvuFRaF2DOhmJQtQ&s",alt:e.professorFullName}})],1),t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.handleFileUpload}})],1)]),t(c.A,{attrs:{cols:"12",md:"9"}},[t(o.OQ,[t(S.A,[t(c.A,{attrs:{cols:"12"}},[t("div",{staticClass:"text-h5 font-weight-bold mb-2"},[e._v(" "+e._s(e.professorFullName)+" ")]),t("div",{staticClass:"text-subtitle-1 grey--text mb-4"},[e._v(" "+e._s(e.professor?.academicInfo?.position||"Faculty Member")+" ")])]),t(c.A,{attrs:{cols:"12",md:"6"}},[t(p.A,{attrs:{dense:""}},[t(f.A,[t(b.A,[t(m.A,[e._v("mdi-card-account-details")])],1),t(v.pr,[t(v.w,[e._v("Employee ID")]),t(v.UZ,[e._v(e._s(e.professor?.employeeId))])],1)],1),t(f.A,[t(b.A,[t(m.A,[e._v("mdi-domain")])],1),t(v.pr,[t(v.w,[e._v("Department")]),t(v.UZ,[e._v(e._s(e.professor?.academicInfo?.department?.name))])],1)],1),t(f.A,[t(b.A,[t(m.A,[e._v("mdi-calendar-clock")])],1),t(v.pr,[t(v.w,[e._v("Date Hired")]),t(v.UZ,[e._v(e._s(e.formatDate(e.professor?.academicInfo?.dateHired)))])],1)],1)],1)],1),t(c.A,{attrs:{cols:"12",md:"6"}},[t(p.A,{attrs:{dense:""}},[t(f.A,[t(b.A,[t(m.A,[e._v("mdi-briefcase")])],1),t(v.pr,[t(v.w,[e._v("Employment Status")]),t(v.UZ,{staticClass:"text-capitalize"},[e._v(e._s(e.professor?.academicInfo?.employmentStatus))])],1)],1),t(f.A,[t(b.A,[t(m.A,[e._v("mdi-account-check")])],1),t(v.pr,[t(v.w,[e._v("Account Status")]),t(v.UZ,[t(n.A,{attrs:{color:e.getStatusColor(e.professor?.accountStatus),small:"",label:"","text-color":"white"}},[e._v(" "+e._s(e.professor?.accountStatus)+" ")])],1)],1)],1),t(f.A,[t(b.A,[t(m.A,[e._v("mdi-book-education")])],1),t(v.pr,[t(v.w,[e._v("Current Load")]),t(v.UZ,[e._v(" "+e._s(e.currentSemesterUnits)+" Units ")])],1)],1)],1)],1)],1)],1)],1)],1)],1),t(r.A,[t(o.ri,{staticClass:"d-flex justify-space-between align-center"},[t("span",[e._v("Teaching Schedule")]),t("div",{staticClass:"d-flex align-center"},[t(_.A,{staticClass:"mr-2",staticStyle:{"min-width":"120px"},attrs:{items:["First","Second"],label:"Semester",dense:"",outlined:"","hide-details":""},model:{value:e.selectedSemester,callback:function(t){e.selectedSemester=t},expression:"selectedSemester"}}),t(_.A,{staticClass:"mr-2",staticStyle:{"min-width":"150px"},attrs:{items:e.academicYears,label:"Academic Year",dense:"",outlined:"","hide-details":""},model:{value:e.selectedYear,callback:function(t){e.selectedYear=t},expression:"selectedYear"}}),t(i.A,{staticClass:"ml-2",attrs:{color:"primary"},on:{click:function(t){return e.openAddLoadDialog()}}},[t(m.A,{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" Add Subject ")],1)],1)]),t(d.A,{staticClass:"mt-4",attrs:{headers:e.teachingLoadHeaders,items:e.currentTeachingLoad.flatMap((e=>e.subjects)),loading:e.loading},scopedSlots:e._u([{key:"item.schedule",fn:function({item:s}){return e._l(s.schedule,(function(s,a){return t("div",{key:a},[t("div",{staticClass:"d-flex align-center"},[t(m.A,{staticClass:"mr-1",attrs:{small:""}},[e._v("mdi-clock-outline")]),t("span",[e._v(e._s(s.day)+": "+e._s(e.formatTime(s.timeStart))+" - "+e._s(e.formatTime(s.timeEnd)))])],1),t("div",{staticClass:"caption grey--text ml-4"},[e._v("Room: "+e._s(s.room))])])}))}},{key:"item.subject.name",fn:function({item:s}){return[t("div",{staticClass:"font-weight-medium"},[e._v(" "+e._s(s.subject?.DescriptiveTitle||"No Title")+" ")]),t("div",{staticClass:"caption grey--text"},[e._v(" "+e._s(s.subject?.catNo||"No Code")+" ")])]}},{key:"item.students",fn:function({item:s}){return[t(n.A,{attrs:{small:""},on:{click:function(t){return e.viewStudents(s)}}},[e._v(" "+e._s((s.students||[]).length)+" students ")])]}},{key:"item.actions",fn:function({item:s}){return[t(i.A,{staticClass:"mr-2",attrs:{icon:"",small:"",color:"primary"},on:{click:function(t){return e.openAddLoadDialog(s)}}},[t(m.A,{attrs:{small:""}},[e._v("mdi-pencil")])],1),t(i.A,{attrs:{icon:"",small:"",color:"error"},on:{click:function(t){return e.confirmDeleteSubject(s)}}},[t(m.A,{attrs:{small:""}},[e._v("mdi-delete")])],1)]}}])})],1),t(u.A,{attrs:{"max-width":"800px"},model:{value:e.addLoadDialog,callback:function(t){e.addLoadDialog=t},expression:"addLoadDialog"}},[t(r.A,[t(o.ri,{staticClass:"headline"},[e._v(" "+e._s(e.isEditing?"Edit Subject Load":"Add Subject Load")+" ")]),t(h.A,{ref:"loadForm",model:{value:e.loadFormValid,callback:function(t){e.loadFormValid=t},expression:"loadFormValid"}},[t(o.OQ,[t(S.A,[t(c.A,{attrs:{cols:"12",sm:"6"}},[t(_.A,{attrs:{items:e.availableSubjects,"item-text":"DescriptiveTitle","item-value":"_id",label:"Subject",rules:e.rules.required,disabled:e.isEditing,outlined:""},scopedSlots:e._u([{key:"selection",fn:function({item:s}){return[e._v(" "+e._s(s?.DescriptiveTitle||"Select Subject")+" "),s?.catNo?t("span",{staticClass:"grey--text text-caption ml-2"},[e._v(" ("+e._s(s.catNo)+") ")]):e._e()]}},{key:"item",fn:function({item:s}){return[t(v.pr,[t(v.UZ,[e._v(e._s(s?.DescriptiveTitle||"No Title"))]),t(v.w,[e._v(e._s(s?.catNo||"No Code"))])],1)]}}]),model:{value:e.newLoad.subject,callback:function(t){e.$set(e.newLoad,"subject",t)},expression:"newLoad.subject"}})],1),t(c.A,{attrs:{cols:"12",sm:"6"}},[t(w.A,{attrs:{label:"Section",rules:e.rules.required,outlined:""},model:{value:e.newLoad.section,callback:function(t){e.$set(e.newLoad,"section",t)},expression:"newLoad.section"}})],1)],1),t("div",{staticClass:"mb-4"},[t("div",{staticClass:"d-flex justify-space-between align-center mb-5"},[t("div",{staticClass:"subtitle-1"},[e._v("Schedule")]),t(i.A,{attrs:{small:"",color:"primary"},on:{click:e.addScheduleSlot}},[t(m.A,{attrs:{left:"",small:""}},[e._v("mdi-plus")]),e._v(" Add Time Slot ")],1)],1),e._l(e.newLoad.schedule,(function(s,a){return t(S.A,{key:a,staticClass:"mb-2"},[t(c.A,{attrs:{cols:"12",sm:"3"}},[t(_.A,{attrs:{items:e.days,label:"Day",rules:e.rules.required,dense:"",outlined:""},model:{value:s.day,callback:function(t){e.$set(s,"day",t)},expression:"slot.day"}})],1),t(c.A,{attrs:{cols:"12",sm:"3"}},[t(w.A,{attrs:{label:"Start Time",type:"time",rules:e.rules.required,dense:"",outlined:""},model:{value:s.timeStart,callback:function(t){e.$set(s,"timeStart",t)},expression:"slot.timeStart"}})],1),t(c.A,{attrs:{cols:"12",sm:"3"}},[t(w.A,{attrs:{label:"End Time",type:"time",rules:e.rules.required,dense:"",outlined:""},model:{value:s.timeEnd,callback:function(t){e.$set(s,"timeEnd",t)},expression:"slot.timeEnd"}})],1),t(c.A,{attrs:{cols:"12",sm:"2"}},[t(w.A,{attrs:{label:"Room",rules:e.rules.required,dense:"",outlined:""},model:{value:s.room,callback:function(t){e.$set(s,"room",t)},expression:"slot.room"}})],1),t(c.A,{staticClass:"d-flex align-center",attrs:{cols:"12",sm:"1"}},[t(i.A,{attrs:{icon:"",small:"",color:"error",disabled:0===a&&1===e.newLoad.schedule.length},on:{click:function(t){return e.removeScheduleSlot(a)}}},[t(m.A,{attrs:{small:""}},[e._v("mdi-delete")])],1)],1)],1)}))],2)],1),t(o.SL,[t(y.A),t(i.A,{attrs:{text:""},on:{click:e.closeAddLoadDialog}},[e._v("Cancel")]),t(i.A,{attrs:{color:"primary",loading:e.loading,disabled:!e.loadFormValid},on:{click:e.submitLoad}},[e._v(" "+e._s(e.isEditing?"Save Changes":"Add Subject")+" ")])],1)],1)],1)],1),t(u.A,{attrs:{"max-width":"900px"},model:{value:e.studentsDialog,callback:function(t){e.studentsDialog=t},expression:"studentsDialog"}},[t(r.A,[t(o.ri,[t("span",[e._v("Students List")]),t(y.A),t(w.A,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.studentSearch,callback:function(t){e.studentSearch=t},expression:"studentSearch"}})],1),t(d.A,{staticClass:"mt-4",attrs:{headers:e.studentHeaders,items:e.selectedSubjectStudents,search:e.studentSearch,loading:e.loading},scopedSlots:e._u([{key:"item.course",fn:function({item:t}){return[e._v(" "+e._s(t.student?.course?.name)+" ")]}},{key:"item.grades.final",fn:function({item:s}){return[e.editingStudent===s._id?[t(w.A,{attrs:{type:"number",dense:"",outlined:"","hide-details":"",min:"0",max:"100"},on:{input:function(t){return e.updateRemarks(s)}},model:{value:s.grades.final,callback:function(t){e.$set(s.grades,"final",t)},expression:"item.grades.final"}})]:t("span",[e._v(e._s(s.grades.final||"N/A"))])]}},{key:"item.grades.remarks",fn:function({item:s}){return[t(n.A,{attrs:{small:"",color:"Passed"===s.grades.remarks?"success":"error","text-color":"white"}},[e._v(" "+e._s(s.grades.remarks||"N/A")+" ")])]}},{key:"item.actions",fn:function({item:s}){return[e.editingStudent===s._id?[t(i.A,{attrs:{icon:"",small:"",color:"success"},on:{click:function(t){e.editingStudent=null}}},[t(m.A,[e._v("mdi-check")])],1)]:t(i.A,{attrs:{icon:"",small:"",color:"primary"},on:{click:function(t){e.editingStudent=s._id}}},[t(m.A,[e._v("mdi-pencil")])],1)]}}])}),t(o.SL,[t(y.A),e.hasGradeChanges&&!e.editingStudent?t(i.A,{attrs:{color:"primary",loading:e.updating,dark:""},on:{click:e.updateAllGrades}},[e._v(" Update All Grades ")]):e._e(),t(i.A,{attrs:{text:""},on:{click:e.closeStudentsDialog}},[e._v("Close")])],1)],1)],1),t(u.A,{attrs:{"max-width":"400"},model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[t(r.A,[t(o.ri,{staticClass:"headline error--text"},[e._v(" Confirm Delete ")]),t(o.OQ,[e._v(" Are you sure you want to remove this subject from the teaching load? "),t("div",{staticClass:"mt-2"},[t("strong",[e._v(e._s(e.subjectToDelete?.subject?.name))]),t("div",{staticClass:"caption grey--text"},[e._v(" Section: "+e._s(e.subjectToDelete?.section)+" ")])])]),t(o.SL,[t(y.A),t(i.A,{attrs:{text:""},on:{click:function(t){e.deleteDialog=!1}}},[e._v("Cancel")]),t(i.A,{attrs:{color:"error",loading:e.loading},on:{click:e.deleteSubject}},[e._v(" Delete ")])],1)],1)],1),t(u.A,{attrs:{"max-width":"500px"},model:{value:e.imageDialog,callback:function(t){e.imageDialog=t},expression:"imageDialog"}},[t(r.A,[t(o.ri,[e._v("Upload Profile Picture")]),t(o.OQ,[e.previewImage?t(g.A,{staticClass:"mb-4",attrs:{src:e.previewImage,"max-height":"300",contain:""}}):t("div",{staticClass:"text-center pa-4"},[t(m.A,{attrs:{size:"64",color:"grey lighten-1"}},[e._v("mdi-image")]),t("div",{staticClass:"text-subtitle-1 grey--text mt-2"},[e._v("No image selected")])],1)],1),t(o.SL,[t(y.A),t(i.A,{attrs:{text:""},on:{click:e.cancelImageUpload}},[e._v("Cancel")]),t(i.A,{attrs:{color:"primary",loading:e.uploading,disabled:!e.previewImage},on:{click:e.uploadImage}},[e._v(" Upload ")])],1)],1)],1),t(A.A,{attrs:{color:e.snackbarColor,timeout:3e3,top:""},scopedSlots:e._u([{key:"action",fn:function({attrs:s}){return[t(i.A,e._b({attrs:{text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",s,!1),[e._v("Close")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")])],1)},L=[],j=(s(4114),s(4603),s(7566),s(8721),s(5353)),C=s(5093),x=s.n(C),D={name:"ProfessorProfileView",data:()=>({selectedYear:"",selectedSemester:"First",addLoadDialog:!1,studentsDialog:!1,deleteDialog:!1,imageDialog:!1,studentSearch:"",loadFormValid:!1,uploading:!1,previewImage:null,selectedFile:null,subjectToDelete:null,selectedSubjectStudents:[],isEditing:!1,editingId:null,newLoad:{subject:null,section:"",schedule:[{day:"",timeStart:"",timeEnd:"",room:""}]},item:[],teachingLoadHeaders:[{text:"Subject",value:"subject.name",width:"25%"},{text:"Schedule",value:"schedule",width:"35%"},{text:"Section",value:"section",width:"15%"},{text:"Students",value:"students",width:"15%"},{text:"Actions",value:"actions",sortable:!1,width:"10%"}],studentHeaders:[{text:"Student ID",value:"student.studentId"},{text:"Name",value:"student.fullName"},{text:"Course",value:"student.course.courseCode"},{text:"Final Grade",value:"grades.final"},{text:"Remarks",value:"grades.remarks"},{text:"Actions",value:"actions"}],days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],rules:{required:[e=>!!e||"This field is required"],subject:[e=>!!e&&!!e.DescriptiveTitle||"Please select a valid subject"]},snackbar:!1,snackbarColor:"",snackbarText:"",editingStudent:null,updating:!1,selectedTeacherLoadId:null}),computed:{...(0,j.aH)({professor:e=>e.professors.currentProfessor,teachingLoad:e=>e.teacherLoad.teacherLoads,subjects:e=>e.subjects.subjects,loading:e=>e.professors.loading||e.teacherLoad.loading}),professorFullName(){if(!this.professor?.name)return"";const{surname:e,firstName:t,middleName:s,nameExtension:a}=this.professor.name;return`${e}, ${t} ${s||""} ${a||""}`.trim()},academicYears(){const e=(new Date).getFullYear();return[`${e-1}-${e}`,`${e}-${e+1}`]},currentTeachingLoad(){return this.teachingLoad&&Array.isArray(this.teachingLoad)?(console.log({load:this.teachingLoad}),this.teachingLoad.filter((e=>e.academicYear===this.selectedYear&&e.semester===this.selectedSemester&&"active"===e.status)).map((e=>({...e,subjects:(e.subjects||[]).map((e=>({...e,subject:{...e.subject,DescriptiveTitle:e.subject?.DescriptiveTitle||"Untitled Subject",catNo:e.subject?.catNo||"No Code"},students:e.students||[]})))})))):[]},currentSemesterUnits(){return this.currentTeachingLoad.reduce(((e,t)=>e+(t.totalUnits||0)),0)},availableSubjects(){if(!this.subjects||!Array.isArray(this.subjects))return[];const e=this.currentTeachingLoad?.map((e=>e.subject?._id)).filter((e=>null!=e));return this.subjects.filter((e=>e&&e.DescriptiveTitle)).filter((t=>!e.includes(t._id))).map((e=>({...e,DescriptiveTitle:e.DescriptiveTitle||"Untitled Subject",catNo:e.catNo||"No Code"})))},hasGradeChanges(){return this.selectedSubjectStudents.some((e=>e.grades.final))}},methods:{...(0,j.i0)({fetchProfessor:"professors/fetchProfessor",fetchProfessorTeacherLoads:"teacherLoad/fetchProfessorTeacherLoads",createTeacherLoad:"teacherLoad/createTeacherLoad",updateTeacherLoad:"teacherLoad/updateTeacherLoad",updateStudentGrade:"teacherLoad/updateStudentGrade",deleteTeacherLoad:"teacherLoad/deleteTeacherLoad",fetchSubjects:"subjects/fetchSubjects",fetchCourses:"courses/fetchCourses"}),getCourseInfo(e){return this.$store.state.courses.courses.find((t=>t._id===e))},formatDate(e){return e?x()(e).format("MMMM D, YYYY"):"N/A"},formatTime(e){return x()(e,"HH:mm").format("hh:mm A")},getStatusColor(e){const t={active:"success",inactive:"grey","on-leave":"warning",terminated:"error"};return t[e]||"grey"},updateRemarks(e){const t=parseFloat(e.grades.final);isNaN(t)?e.grades.remarks="N/A":e.grades.remarks=t<=3?"Passed":"Failed"},getRemarkColor(e){return parseFloat(e)>=75?"success":"error"},getRemarkText(e){return parseFloat(e)>=75?"Passed":"Failed"},triggerFileInput(){this.$refs.fileInput.click()},handleFileUpload(e){const t=e.target.files[0];t&&(t.type.includes("image/")?(this.selectedFile=t,this.previewImage=URL.createObjectURL(t),this.imageDialog=!0):this.showSnackbarMessage("Please select an image file","error"))},async uploadImage(){if(this.selectedFile){this.uploading=!0;try{const e=new FormData;e.append("profilePicture",this.selectedFile),await this.updateProfessorImage({id:this.professor._id,formData:e}),this.showSnackbarMessage("Profile picture updated successfully","success"),this.imageDialog=!1}catch(e){this.showSnackbarMessage(e.response?.data?.message||"Failed to update profile picture","error")}finally{this.uploading=!1}}},cancelImageUpload(){this.imageDialog=!1,this.previewImage=null,this.selectedFile=null,this.$refs.fileInput.value=""},openAddLoadDialog(e=null){this.isEditing=Boolean(e),e?(this.editingId=e._id,this.newLoad={subject:e.subject?._id,section:e.section||"",schedule:Array.isArray(e.schedule)?JSON.parse(JSON.stringify(e.schedule)):[{day:"",timeStart:"",timeEnd:"",room:""}]}):(this.editingId=null,this.resetLoadForm()),this.addLoadDialog=!0},async updateAllGrades(){if(this.selectedTeacherLoadId){this.updating=!0;try{await this.updateStudentGrade({teacherLoadId:this.selectedTeacherLoadId,subjectId:this.selectedSubjectId,students:this.selectedSubjectStudents.map((e=>({student:e._id,grades:e.grades})))}),this.showSnackbarMessage("Grades updated successfully","success"),this.studentsDialog=!1}catch(e){this.showSnackbarMessage("Failed to update grades","error")}this.updating=!1}else this.showSnackbarMessage("Teacher load ID not found","error")},closeAddLoadDialog(){this.addLoadDialog=!1,this.isEditing=!1,this.editingId=null,this.resetLoadForm()},resetLoadForm(){this.newLoad={subject:null,section:"",schedule:[{day:"",timeStart:"",timeEnd:"",room:""}]},this.$refs.loadForm&&this.$refs.loadForm.resetValidation()},addScheduleSlot(){this.newLoad.schedule.push({day:"",timeStart:"",timeEnd:"",room:""})},removeScheduleSlot(e){this.newLoad.schedule.splice(e,1)},async submitLoad(){if(this.$refs.loadForm.validate())try{const e={professor:this.professor?._id,academicYear:this.selectedYear,semester:this.selectedSemester,subjects:[{subject:this.newLoad.subject,section:this.newLoad.section,schedule:this.newLoad.schedule.map((e=>({day:e.day,timeStart:e.timeStart,timeEnd:e.timeEnd,room:e.room}))),students:[]}]},t=await this.$store.dispatch("teacherLoad/checkScheduleConflicts",{schedule:this.newLoad.schedule,skipSubjectId:this.isEditing?this.editingId:null,professorId:e.professor});if(t.hasConflict){const{day:e,existingTime:s,room:a,professor:i,isSameProfessor:r}=t.conflictDetails;let o=r?`You already have a class scheduled on ${e} at ${s}`:`Room ${a} is already occupied on ${e} at ${s} by ${i.name?.firstName} ${i.name?.surname}`;return void this.showSnackbarMessage(o,"error")}if(!e.professor||!e.subjects[0].subject)throw new Error("Missing required fields");if(this.isEditing){console.log(this.isEditing);const t=this.currentTeachingLoad.find((e=>e.subjects.some((e=>e._id===this.editingId))));if(!t)throw new Error("Teacher load not found");const s=t.subjects.map((t=>t._id===this.editingId?{...t,...e.subjects[0]}:t));await this.updateTeacherLoad({id:t._id,data:{...t,subjects:s}}),this.showSnackbarMessage("Schedule updated successfully","success")}else await this.createTeacherLoad(e),this.showSnackbarMessage("Subject added to teaching load successfully","success");this.closeAddLoadDialog(),await this.fetchProfessorTeacherLoads(this.professor._id)}catch(e){console.error("Error submitting load:",e),this.showSnackbarMessage(e.response?.data?.message||`Failed to ${this.isEditing?"update":"add"} subject`,"error")}},viewStudents(e){const t=this.currentTeachingLoad.find((t=>t.subjects.some((t=>t._id===e._id))));this.selectedTeacherLoadId=t?._id,this.selectedSubjectStudents=e?.students||[],this.selectedSubjectId=e._id,this.studentsDialog=!0},confirmDeleteSubject(e){this.subjectToDelete=e,this.deleteDialog=!0},async deleteSubject(e){try{const t=this.currentTeachingLoad.find((t=>t.subjects.some((t=>t._id===e._id))));if(!t)throw new Error("Teacher load not found");const s=t.subjects.filter((t=>t._id!==e._id));await this.updateTeacherLoad({id:t._id,data:{...t,subjects:s}}),this.showSnackbarMessage("Subject removed successfully","success"),this.deleteDialog=!1,await this.fetchProfessorTeacherLoads(this.professor._id)}catch(t){console.error("Error deleting subject:",t),this.showSnackbarMessage(t.response?.data?.message||"Failed to remove subject","error")}},showSnackbarMessage(e,t){this.snackbarText=e,this.snackbarColor=t,this.snackbar=!0},async loadInitialData(){const e=this.$route.params.id;if(e)try{await Promise.all([this.fetchProfessor(e),this.fetchProfessorTeacherLoads(e),this.fetchSubjects(),this.fetchCourses()]),this.selectedYear=this.academicYears[0]}catch(t){console.error("Error loading data:",t),this.showSnackbarMessage("Failed to load data","error")}else this.showSnackbarMessage("Invalid professor ID","error")},closeStudentsDialog(){this.studentsDialog=!1,this.editingStudent=null,this.selectedSubjectStudents=[],this.selectedSubjectId=null,this.selectedTeacherLoadId=null}},created(){this.loadInitialData()}},T=D,I=s(1656),$=(0,I.A)(T,k,L,!1,null,"195aeb14",null),E=$.exports},174:function(e,t,s){s(4114);var a=s(5803),i=s(7717),r=s(7540),o=s(4152);t.A=(0,a.A)(i.A,(0,r.G)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",(t=>{this.$set(this.errorBag,e._uid,t)}),{immediate:!0}),s={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?s.shouldValidate=e.$watch("shouldValidate",(a=>{a&&(this.errorBag.hasOwnProperty(e._uid)||(s.valid=t(e)))})):s.valid=t(e),s},validate(){return 0===this.inputs.filter((e=>!e.validate(!0))).length},reset(){this.inputs.forEach((e=>e.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((e=>e.resetValidation())),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find((t=>t._uid===e._uid));if(!t)return;const s=this.watchers.find((e=>e._uid===t._uid));s&&(s.valid(),s.shouldValidate()),this.watchers=this.watchers.filter((e=>e._uid!==t._uid)),this.inputs=this.inputs.filter((e=>e._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},(0,o.$c)(this))}})},5420:function(e,t,s){s.d(t,{A:function(){return m}});s(4114);var a=s(1677),i=s(7282),r=s(5803),o=s(4152),n=(0,r.A)(i.A).extend({name:"v-responsive",props:{aspectRatio:[String,Number],contentClass:String},computed:{computedAspectRatio(){return Number(this.aspectRatio)},aspectStyle(){return this.computedAspectRatio?{paddingBottom:1/this.computedAspectRatio*100+"%"}:void 0},__cachedSizer(){return this.aspectStyle?this.$createElement("div",{style:this.aspectStyle,staticClass:"v-responsive__sizer"}):[]}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-responsive__content",class:this.contentClass},(0,o.$c)(this))}},render(e){return e("div",{staticClass:"v-responsive",style:this.measurableStyles,on:this.$listeners},[this.__cachedSizer,this.genContent()])}}),c=n,l=s(3381),d=s(8041),u=s(6988);const h="undefined"!==typeof window&&"IntersectionObserver"in window;var m=(0,r.A)(c,l.A).extend({name:"v-img",directives:{intersect:a.A},props:{alt:String,contain:Boolean,eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},position:{type:String,default:"center center"},sizes:String,src:{type:[String,Object],default:""},srcset:String,transition:{type:[Boolean,String],default:"fade-transition"}},data(){return{currentSrc:"",image:null,isLoading:!0,calculatedAspectRatio:void 0,naturalWidth:void 0,hasError:!1}},computed:{computedAspectRatio(){return Number(this.normalisedSrc.aspect||this.calculatedAspectRatio)},normalisedSrc(){return this.src&&"object"===typeof this.src?{src:this.src.src,srcset:this.srcset||this.src.srcset,lazySrc:this.lazySrc||this.src.lazySrc,aspect:Number(this.aspectRatio||this.src.aspect)}:{src:this.src,srcset:this.srcset,lazySrc:this.lazySrc,aspect:Number(this.aspectRatio||0)}},__cachedImage(){if(!(this.normalisedSrc.src||this.normalisedSrc.lazySrc||this.gradient))return[];const e=[],t=this.isLoading?this.normalisedSrc.lazySrc:this.currentSrc;this.gradient&&e.push(`linear-gradient(${this.gradient})`),t&&e.push(`url("${t}")`);const s=this.$createElement("div",{staticClass:"v-image__image",class:{"v-image__image--preload":this.isLoading,"v-image__image--contain":this.contain,"v-image__image--cover":!this.contain},style:{backgroundImage:e.join(", "),backgroundPosition:this.position},key:+this.isLoading});return this.transition?this.$createElement("transition",{attrs:{name:this.transition,mode:"in-out"}},[s]):s}},watch:{src(){this.isLoading?this.loadImage():this.init(void 0,void 0,!0)},"$vuetify.breakpoint.width":"getSrc"},mounted(){this.init()},methods:{init(e,t,s){if(!h||s||this.eager){if(this.normalisedSrc.lazySrc){const e=new Image;e.src=this.normalisedSrc.lazySrc,this.pollForSize(e,null)}this.normalisedSrc.src&&this.loadImage()}},onLoad(){this.getSrc(),this.isLoading=!1,this.$emit("load",this.src),this.image&&(this.normalisedSrc.src.endsWith(".svg")||this.normalisedSrc.src.startsWith("data:image/svg+xml"))&&(this.image.naturalHeight&&this.image.naturalWidth?(this.naturalWidth=this.image.naturalWidth,this.calculatedAspectRatio=this.image.naturalWidth/this.image.naturalHeight):this.calculatedAspectRatio=1)},onError(){this.hasError=!0,this.$emit("error",this.src)},getSrc(){this.image&&(this.currentSrc=this.image.currentSrc||this.image.src)},loadImage(){const e=new Image;this.image=e,e.onload=()=>{e.decode?e.decode().catch((e=>{(0,u.OP)(`Failed to decode image, trying to render anyway\n\nsrc: ${this.normalisedSrc.src}`+(e.message?`\nOriginal error: ${e.message}`:""),this)})).then(this.onLoad):this.onLoad()},e.onerror=this.onError,this.hasError=!1,this.sizes&&(e.sizes=this.sizes),this.normalisedSrc.srcset&&(e.srcset=this.normalisedSrc.srcset),e.src=this.normalisedSrc.src,this.$emit("loadstart",this.normalisedSrc.src),this.aspectRatio||this.pollForSize(e),this.getSrc()},pollForSize(e,t=100){const s=()=>{const{naturalHeight:a,naturalWidth:i}=e;a||i?(this.naturalWidth=i,this.calculatedAspectRatio=i/a):e.complete||!this.isLoading||this.hasError||null==t||setTimeout(s,t)};s()},genContent(){const e=c.options.methods.genContent.call(this);return this.naturalWidth&&this._b(e.data,"div",{style:{width:`${this.naturalWidth}px`}}),e},__genPlaceholder(){const e=(0,o.$c)(this,"placeholder");if(e){const t=this.isLoading?[this.$createElement("div",{staticClass:"v-image__placeholder"},e)]:[];return this.transition?this.$createElement("transition",{props:{appear:!0,name:this.transition}},t):t[0]}}},render(e){const t=c.options.render.call(this,e),s=(0,d.Ay)(t.data,{staticClass:"v-image",attrs:{"aria-label":this.alt,role:this.alt?"img":void 0},class:this.themeClasses,directives:h?[{name:"intersect",modifiers:{once:!0},value:{handler:this.init,options:this.options}}]:void 0});return t.children=[this.__cachedSizer,this.__cachedImage,this.__genPlaceholder(),this.genContent()],e(t.tag,s,t.children)}})},2812:function(e){var t=TypeError;e.exports=function(e,s){if(e<s)throw new t("Not enough arguments");return e}},4603:function(e,t,s){var a=s(6840),i=s(9504),r=s(655),o=s(2812),n=URLSearchParams,c=n.prototype,l=i(c.append),d=i(c["delete"]),u=i(c.forEach),h=i([].push),m=new n("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&a(c,"delete",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return d(this,e);var a=[];u(this,(function(e,t){h(a,{key:t,value:e})})),o(t,1);var i,n=r(e),c=r(s),m=0,g=0,p=!1,f=a.length;while(m<f)i=a[m++],p||i.key===n?(p=!0,d(this,i.key)):g++;while(g<f)i=a[g++],i.key===n&&i.value===c||l(this,i.key,i.value)}),{enumerable:!0,unsafe:!0})},7566:function(e,t,s){var a=s(6840),i=s(9504),r=s(655),o=s(2812),n=URLSearchParams,c=n.prototype,l=i(c.getAll),d=i(c.has),u=new n("a=1");!u.has("a",2)&&u.has("a",void 0)||a(c,"has",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return d(this,e);var a=l(this,e);o(t,1);var i=r(s),n=0;while(n<a.length)if(a[n++]===i)return!0;return!1}),{enumerable:!0,unsafe:!0})},8721:function(e,t,s){var a=s(3724),i=s(9504),r=s(2106),o=URLSearchParams.prototype,n=i(o.forEach);a&&!("size"in o)&&r(o,"size",{get:function(){var e=0;return n(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=888.2ff7b265.js.map