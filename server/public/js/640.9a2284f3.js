"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[640],{3141:function(e,t,s){s.r(t),s.d(t,{default:function(){return x}});var r=s(3740),a=s(3698),i=s(2938),o=s(3180),n=s(4414),l=s(3449),c=s(3064),d=s(9991),u=s(6930),m=s(2756),p=s(5834),h=s(7150),f=s(1034),g=s(7112),C=function(){var e=this,t=e._self._c;return t(l.A,[t(a.A,{staticClass:"mb-4"},[t(m.A,{attrs:{align:"center","no-gutters":""}},[t(n.A,{attrs:{cols:"12"}},[t("div",{staticClass:"d-flex justify-space-between pa-4"},[t(g.A,{staticClass:"search-field",staticStyle:{"max-width":"400px"},attrs:{"prepend-inner-icon":"mdi-magnify",placeholder:"Search courses...","hide-details":"","single-line":"",filled:"",rounded:"",dense:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadCourses.apply(null,arguments)}},model:{value:e.options.search,callback:function(t){e.$set(e.options,"search",t)},expression:"options.search"}}),t(r.A,{attrs:{color:"primary"},on:{click:e.openCreateDialog}},[t(u.A,{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" New Course ")],1)],1)])],1)],1),t(a.A,[t(c.A,{attrs:{headers:e.headers,items:e.courses,loading:e.loading,"items-per-page":10,search:e.options.search},scopedSlots:e._u([{key:"item.departments",fn:function({item:s}){return e._l(s.departments,(function(s){return t(o.A,{key:s._id,staticClass:"mr-1 mb-1",attrs:{small:""}},[e._v(" "+e._s(s.name)+" ")])}))}},{key:"item.actions",fn:function({item:s}){return[t("div",{staticClass:"d-flex justify-end"},[t(r.A,{staticClass:"mr-2",attrs:{icon:"",small:"",color:"primary"},on:{click:function(t){return e.openEditDialog(s)}}},[t(u.A,{attrs:{small:""}},[e._v("mdi-pencil")])],1),t(r.A,{attrs:{icon:"",small:"",color:"error"},on:{click:function(t){return e.confirmDelete(s)}}},[t(u.A,{attrs:{small:""}},[e._v("mdi-delete")])],1)],1)]}},{key:"no-data",fn:function(){return[t("div",{staticClass:"pa-8 text-center"},[t(u.A,{attrs:{size:"64",color:"grey lighten-1"}},[e._v("mdi-book-outline")]),t("div",{staticClass:"text-h6 grey--text text--darken-1 mt-4"},[e._v(" No courses found ")]),t("div",{staticClass:"text-body-2 grey--text mt-2"},[e._v(" Try adjusting your search or add a new course ")])],1)]},proxy:!0}])})],1),t(d.A,{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(a.A,[t(i.ri,[t("span",{staticClass:"text-h5"},[e._v(e._s(e.formTitle))])]),t(i.OQ,[t(l.A,[t(m.A,[t(n.A,{attrs:{cols:"12"}},[t(g.A,{attrs:{label:"Course Name","error-messages":e.nameError,required:""},model:{value:e.editedItem.courseName,callback:function(t){e.$set(e.editedItem,"courseName",t)},expression:"editedItem.courseName"}})],1),t(n.A,{attrs:{cols:"12"}},[t(g.A,{attrs:{label:"Course Code","error-messages":e.codeError,required:""},model:{value:e.editedItem.courseCode,callback:function(t){e.$set(e.editedItem,"courseCode",t)},expression:"editedItem.courseCode"}})],1),e.isAdmin?t(n.A,{attrs:{cols:"12"}},[t(p.A,{attrs:{items:e.filteredDepartments,"item-text":"name","item-value":"_id",label:"Departments","error-messages":e.departmentError,multiple:"",chips:"","deletable-chips":"",required:""},model:{value:e.editedItem.departments,callback:function(t){e.$set(e.editedItem,"departments",t)},expression:"editedItem.departments"}})],1):e._e()],1)],1)],1),t(i.SL,[t(f.A),t(r.A,{attrs:{text:""},on:{click:e.closeDialog}},[e._v("Cancel")]),t(r.A,{attrs:{color:"primary",loading:e.loading},on:{click:e.saveCourse}},[e._v(" Save ")])],1)],1)],1),t(d.A,{attrs:{"max-width":"400"},model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[t(a.A,[t(i.ri,{staticClass:"error--text"},[t(u.A,{attrs:{left:"",color:"error"}},[e._v("mdi-alert-circle")]),e._v(" Confirm Delete ")],1),t(i.OQ,{staticClass:"pt-4"},[e._v(" Are you sure you want to delete this course? "),t("div",{staticClass:"mt-4 pa-4 grey lighten-4 rounded"},[t("div",{staticClass:"font-weight-medium"},[e._v(" "+e._s(e.courseToDelete?.courseName)+" ")]),t("div",{staticClass:"caption text-medium-emphasis"},[e._v(" Code: "+e._s(e.courseToDelete?.courseCode)+" ")]),t("div",{staticClass:"caption text-medium-emphasis"},[e._v(" Departments: "),t("div",{staticClass:"mt-1"},e._l(e.courseToDelete?.departments,(function(s){return t(o.A,{key:s._id,staticClass:"mr-1 mb-1",attrs:{"x-small":""}},[e._v(" "+e._s(s.name)+" ")])})),1)])])]),t(i.SL,[t(f.A),t(r.A,{attrs:{text:""},on:{click:function(t){e.deleteDialog=!1}}},[e._v("Cancel")]),t(r.A,{attrs:{color:"error",loading:e.loading},on:{click:e.handleDelete}},[e._v(" Delete ")])],1)],1)],1),t(h.A,{attrs:{color:e.snackbarColor,timeout:4e3,top:"",right:""},scopedSlots:e._u([{key:"action",fn:function({attrs:s}){return[t(r.A,e._b({attrs:{icon:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",s,!1),[t(u.A,[e._v("mdi-close")])],1)]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")])],1)},y=[],b=s(5353),v={name:"CourseListView",data:()=>({dialog:!1,deleteDialog:!1,currentUser:null,options:{search:""},headers:[{text:"Course Name",value:"courseName",sortable:!0},{text:"Course Code",value:"courseCode",sortable:!0},{text:"Departments",value:"departments",sortable:!1},{text:"Actions",value:"actions",sortable:!1,align:"end"}],editedItem:{courseName:"",courseCode:"",departments:[]},defaultItem:{courseName:"",courseCode:"",departments:[]},courseToDelete:null,nameError:"",codeError:"",departmentError:"",snackbar:!1,snackbarColor:"",snackbarText:""}),computed:{...(0,b.aH)("courses",["courses","loading"]),...(0,b.aH)("departments",["departments"]),...(0,b.L8)("departments",["filteredDepartments"]),isAdmin(){return!!this.currentUser&&this.currentUser.role.some((e=>"admin"===e.name))},formTitle(){return this.editedItem._id?"Edit Course":"New Course"}},methods:{...(0,b.i0)("courses",["fetchCourses","fetchCoursesByDepartment","createCourse","updateCourse","deleteCourse"]),...(0,b.i0)("departments",["fetchDepartments"]),getCurrentUser(){const e=localStorage.getItem("user");if(e)try{const t=JSON.parse(e);this.currentUser=t.user}catch(t){console.error("Error parsing user data:",t),this.currentUser=null,this.showSnackbarMessage("Error loading user data","error")}},async loadCourses(){try{this.isAdmin?await this.fetchCourses():this.currentUser?.department&&await this.fetchCoursesByDepartment(this.currentUser.department)}catch(e){this.showSnackbarMessage("Failed to load courses","error")}},async loadDepartments(){try{await this.fetchDepartments()}catch(e){this.showSnackbarMessage("Failed to load departments","error")}},openCreateDialog(){this.editedItem={...this.defaultItem},!this.isAdmin&&this.currentUser?.department&&(this.editedItem.departments=[this.currentUser.department]),this.dialog=!0},openEditDialog(e){this.editedItem={...e},e.departments&&(this.editedItem.departments=e.departments.map((e=>e._id))),this.dialog=!0},closeDialog(){this.dialog=!1,this.nameError="",this.codeError="",this.departmentError="",this.$nextTick((()=>{this.editedItem={...this.defaultItem}}))},validateForm(){let e=!0;return this.nameError="",this.codeError="",this.departmentError="",this.editedItem.courseName?.trim()||(this.nameError="Course name is required",e=!1),this.editedItem.courseCode?.trim()||(this.codeError="Course code is required",e=!1),this.editedItem.departments?.length||(this.departmentError="At least one department is required",e=!1),e},async saveCourse(){if(this.validateForm())try{const e={...this.editedItem,departments:this.isAdmin?this.editedItem.departments:[this.currentUser.department]};this.editedItem._id?(await this.updateCourse({id:this.editedItem._id,courseData:e}),this.showSnackbarMessage("Course updated successfully!","success")):(await this.createCourse(e),this.showSnackbarMessage("Course created successfully!","success")),this.closeDialog(),this.loadCourses()}catch(e){this.showSnackbarMessage(e.response?.data?.message||"Operation failed!","error")}},confirmDelete(e){this.courseToDelete=e,this.deleteDialog=!0},async handleDelete(){try{await this.deleteCourse(this.courseToDelete._id),this.showSnackbarMessage("Course deleted successfully!","success"),this.loadCourses()}catch(e){this.showSnackbarMessage(e.response?.data?.message||"Failed to delete course!","error")}finally{this.deleteDialog=!1,this.courseToDelete=null}},showSnackbarMessage(e,t){this.snackbarText=e,this.snackbarColor=t,this.snackbar=!0}},async created(){try{this.getCurrentUser(),await Promise.all([this.loadDepartments(),this.loadCourses()])}catch(e){this.showSnackbarMessage("Failed to initialize page","error")}}},k=v,A=s(1656),_=(0,A.A)(k,C,y,!1,null,"e3b87596",null),x=_.exports},4414:function(e,t,s){s(4114),s(125);var r=s(5471),a=s(8041),i=s(4152);const o=["sm","md","lg","xl"],n=(()=>o.reduce(((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e)),{}))(),l=(()=>o.reduce(((e,t)=>(e["offset"+(0,i.Zb)(t)]={type:[String,Number],default:null},e)),{}))(),c=(()=>o.reduce(((e,t)=>(e["order"+(0,i.Zb)(t)]={type:[String,Number],default:null},e)),{}))(),d={col:Object.keys(n),offset:Object.keys(l),order:Object.keys(c)};function u(e,t,s){let r=e;if(null!=s&&!1!==s){if(t){const s=t.replace(e,"");r+=`-${s}`}return"col"!==e||""!==s&&!0!==s?(r+=`-${s}`,r.toLowerCase()):r.toLowerCase()}}const m=new Map;t.A=r.Ay.extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...n,offset:{type:[String,Number],default:null},...l,order:{type:[String,Number],default:null},...c,alignSelf:{type:String,default:null,validator:e=>["auto","start","end","center","baseline","stretch"].includes(e)},tag:{type:String,default:"div"}},render(e,{props:t,data:s,children:r,parent:i}){let o="";for(const a in t)o+=String(t[a]);let n=m.get(o);if(!n){let e;for(e in n=[],d)d[e].forEach((s=>{const r=t[s],a=u(e,s,r);a&&n.push(a)}));const s=n.some((e=>e.startsWith("col-")));n.push({col:!s||!t.cols,[`col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),m.set(o,n)}return e(t.tag,(0,a.Ay)(s,{class:n}),r)}})},2756:function(e,t,s){s(4114),s(125);var r=s(5471),a=s(8041),i=s(4152);const o=["sm","md","lg","xl"],n=["start","end","center"];function l(e,t){return o.reduce(((s,r)=>(s[e+(0,i.Zb)(r)]=t(),s)),{})}const c=e=>[...n,"baseline","stretch"].includes(e),d=l("align",(()=>({type:String,default:null,validator:c}))),u=e=>[...n,"space-between","space-around"].includes(e),m=l("justify",(()=>({type:String,default:null,validator:u}))),p=e=>[...n,"space-between","space-around","stretch"].includes(e),h=l("alignContent",(()=>({type:String,default:null,validator:p}))),f={align:Object.keys(d),justify:Object.keys(m),alignContent:Object.keys(h)},g={align:"align",justify:"justify",alignContent:"align-content"};function C(e,t,s){let r=g[e];if(null!=s){if(t){const s=t.replace(e,"");r+=`-${s}`}return r+=`-${s}`,r.toLowerCase()}}const y=new Map;t.A=r.Ay.extend({name:"v-row",functional:!0,props:{tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:c},...d,justify:{type:String,default:null,validator:u},...m,alignContent:{type:String,default:null,validator:p},...h},render(e,{props:t,data:s,children:r}){let i="";for(const a in t)i+=String(t[a]);let o=y.get(i);if(!o){let e;for(e in o=[],f)f[e].forEach((s=>{const r=t[s],a=C(e,s,r);a&&o.push(a)}));o.push({"no-gutters":t.noGutters,"row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),y.set(i,o)}return e(t.tag,(0,a.Ay)(s,{staticClass:"row",class:o}),r)}})}}]);
//# sourceMappingURL=640.9a2284f3.js.map