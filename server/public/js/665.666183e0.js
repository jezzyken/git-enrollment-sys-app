"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[665],{9804:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var s=a(3740),i=a(3698),r=a(2938),n=a(4414),o=a(3449),l=a(3064),d=a(9991),c=a(174),h=a(6930),m=a(2756),u=a(7150),p=a(1034),f=a(7112),g=function(){var e=this,t=e._self._c;return t(o.A,[t(i.A,{staticClass:"mb-4"},[t(m.A,{attrs:{align:"center","no-gutters":""}},[t(n.A,{attrs:{cols:"12"}},[t("div",{staticClass:"d-flex justify-space-between pa-4"},[t(f.A,{staticClass:"search-field",staticStyle:{"max-width":"300px"},attrs:{"prepend-inner-icon":"mdi-magnify",placeholder:"Search departments...","hide-details":"","single-line":"",filled:"",rounded:"",dense:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetchDepartments.apply(null,arguments)}},model:{value:e.options.search,callback:function(t){e.$set(e.options,"search",t)},expression:"options.search"}}),t(s.A,{attrs:{color:"primary"},on:{click:e.openCreateDialog}},[t(h.A,{attrs:{left:""}},[e._v("mdi-plus")]),e._v(" New Department ")],1)],1)])],1)],1),t(i.A,[t(l.A,{attrs:{headers:e.headers,items:e.departments,loading:e.loading,options:e.options,"server-items-length":e.totalDepartments,"items-per-page":10},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item.actions",fn:function({item:a}){return[t("div",{staticClass:"d-flex justify-end"},[t(s.A,{staticClass:"mr-2",attrs:{icon:"",small:"",color:"primary"},on:{click:function(t){return e.editDepartment(a)}}},[t(h.A,{attrs:{small:""}},[e._v("mdi-pencil")])],1),t(s.A,{attrs:{icon:"",small:"",color:"error"},on:{click:function(t){return e.confirmDelete(a)}}},[t(h.A,{attrs:{small:""}},[e._v("mdi-delete")])],1)],1)]}},{key:"no-data",fn:function(){return[t("div",{staticClass:"pa-8 text-center"},[t(h.A,{attrs:{size:"64",color:"grey lighten-1"}},[e._v("mdi-domain")]),t("div",{staticClass:"text-h6 grey--text text--darken-1 mt-4"},[e._v(" No departments found ")]),t("div",{staticClass:"text-body-2 grey--text mt-2"},[e._v(" Try adjusting your search or add a new department ")])],1)]},proxy:!0}])})],1),t(d.A,{attrs:{"max-width":"500px"},model:{value:e.createDialog,callback:function(t){e.createDialog=t},expression:"createDialog"}},[t(i.A,[t(r.ri,[t("span",{staticClass:"text-h5"},[e._v(e._s(e.editMode?"Edit Department":"New Department"))])]),t(r.OQ,[t(o.A,[t(c.A,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(m.A,[t(n.A,{attrs:{cols:"12"}},[t(f.A,{attrs:{rules:e.formRules.name,label:"Department Name",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1)],1)],1),t(r.SL,[t(p.A),t(s.A,{attrs:{text:""},on:{click:e.closeCreateDialog}},[e._v("Cancel")]),t(s.A,{attrs:{color:"primary",disabled:!e.valid,loading:e.loading},on:{click:e.handleCreate}},[e._v(" "+e._s(e.editMode?"Save":"Create")+" ")])],1)],1)],1),t(d.A,{attrs:{"max-width":"400"},model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[t(i.A,[t(r.ri,{staticClass:"error--text"},[t(h.A,{attrs:{left:"",color:"error"}},[e._v("mdi-alert-circle")]),e._v(" Confirm Delete ")],1),t(r.OQ,{staticClass:"pt-4"},[e._v(" Are you sure you want to delete this department? "),t("div",{staticClass:"mt-4 pa-4 grey lighten-4 rounded"},[t("div",{staticClass:"font-weight-medium"},[e._v(" "+e._s(e.departmentToDelete?.name)+" ")])])]),t(r.SL,[t(p.A),t(s.A,{attrs:{text:""},on:{click:function(t){e.deleteDialog=!1}}},[e._v("Cancel")]),t(s.A,{attrs:{color:"error",loading:e.loading},on:{click:e.handleDelete}},[e._v(" Delete ")])],1)],1)],1),t(u.A,{attrs:{color:e.snackbarColor,timeout:3e3,top:"",right:""},scopedSlots:e._u([{key:"action",fn:function({attrs:a}){return[t(s.A,e._b({attrs:{icon:""},on:{click:function(t){e.showSnackbar=!1}}},"v-btn",a,!1),[t(h.A,[e._v("mdi-close")])],1)]}}]),model:{value:e.showSnackbar,callback:function(t){e.showSnackbar=t},expression:"showSnackbar"}},[e._v(" "+e._s(e.snackbarText)+" ")])],1)},v=[],D=a(5353),k={name:"DepartmentListView",data:()=>({valid:!1,options:{page:1,itemsPerPage:10,search:""},createDialog:!1,deleteDialog:!1,departmentToDelete:null,form:{name:""},formRules:{name:[e=>!!e||"Department name is required"]},headers:[{text:"Department Name",align:"start",value:"name"},{text:"Actions",value:"actions",sortable:!1,align:"end"}],editMode:!1,loading:!1,snackbarColor:"",snackbarText:"",showSnackbar:!1}),computed:{...(0,D.aH)("departments",["departments","totalDepartments"])},methods:{...(0,D.i0)("departments",["fetchDepartments","createDepartment","updateDepartment","deleteDepartment"]),openCreateDialog(){this.editMode=!1,this.createDialog=!0,this.form={name:""}},closeCreateDialog(){this.createDialog=!1,this.form={name:""},this.$refs.form&&this.$refs.form.reset()},async handleCreate(){if(this.$refs.form.validate()){this.loading=!0;try{this.editMode?(await this.updateDepartment({id:this.form._id,departmentData:this.form}),this.showSnackbarMessage("Department updated successfully!","success")):(await this.createDepartment(this.form),this.showSnackbarMessage("Department created successfully!","success")),this.fetchDepartments(),this.closeCreateDialog()}catch(e){this.showSnackbarMessage(e.response?.data?.message||"An error occurred!","error")}finally{this.loading=!1}}},editDepartment(e){this.editMode=!0,this.form={...e},this.createDialog=!0},confirmDelete(e){this.departmentToDelete=e,this.deleteDialog=!0},async handleDelete(){this.loading=!0;try{await this.deleteDepartment(this.departmentToDelete._id),this.showSnackbarMessage("Department deleted successfully!","success"),this.fetchDepartments()}catch(e){this.showSnackbarMessage("Failed to delete department!","error")}finally{this.loading=!1,this.deleteDialog=!1}},showSnackbarMessage(e,t){this.snackbarText=e,this.snackbarColor=t,this.showSnackbar=!0},async handleSearch(){this.options.page=1,await this.fetchDepartments()}},created(){this.fetchDepartments()}},_=k,y=a(1656),A=(0,y.A)(_,g,v,!1,null,"2ed0db4d",null),b=A.exports},174:function(e,t,a){a(4114);var s=a(5803),i=a(7717),r=a(7540),n=a(4152);t.A=(0,s.A)(i.A,(0,r.G)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",(t=>{this.$set(this.errorBag,e._uid,t)}),{immediate:!0}),a={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=e.$watch("shouldValidate",(s=>{s&&(this.errorBag.hasOwnProperty(e._uid)||(a.valid=t(e)))})):a.valid=t(e),a},validate(){return 0===this.inputs.filter((e=>!e.validate(!0))).length},reset(){this.inputs.forEach((e=>e.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((e=>e.resetValidation())),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find((t=>t._uid===e._uid));if(!t)return;const a=this.watchers.find((e=>e._uid===t._uid));a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter((e=>e._uid!==t._uid)),this.inputs=this.inputs.filter((e=>e._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},(0,n.$c)(this))}})}}]);
//# sourceMappingURL=665.666183e0.js.map