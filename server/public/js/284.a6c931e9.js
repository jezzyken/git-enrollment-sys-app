"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[284],{1284:function(s,t,a){a.r(t),a.d(t,{default:function(){return k}});var e=a(3740),r=a(3698),i=a(2938),o=a(4414),n=a(3449),d=a(9483),l=a(174),c=a(2756),h=a(7150),u=a(1034),w=a(7112),p=function(){var s=this,t=s._self._c;return t(n.A,{staticClass:"py-6"},[t(r.A,{staticClass:"mx-auto",attrs:{"max-width":"700",elevation:"1"}},[t(i.ri,{staticClass:"text-h5 pa-4"},[s._v("Profile Settings")]),t(i.OQ,{staticClass:"pa-4"},[t(l.A,{ref:"form",model:{value:s.valid,callback:function(t){s.valid=t},expression:"valid"}},[t(c.A,[t(o.A,{attrs:{cols:"12"}},[t("div",{staticClass:"text-subtitle-1 mb-4"},[s._v("Account Information")]),"student"!==s.formData.roles?t(w.A,{staticClass:"mb-2",attrs:{label:"Email Address",rules:s.emailRules,type:"email",required:"",outlined:"",dense:""},model:{value:s.formData.email,callback:function(t){s.$set(s.formData,"email",t)},expression:"formData.email"}}):s._e(),t(w.A,{attrs:{label:"Username",required:"",outlined:"",dense:""},model:{value:s.formData.username,callback:function(t){s.$set(s.formData,"username",t)},expression:"formData.username"}})],1),t(o.A,{staticClass:"mt-4",attrs:{cols:"12"}},[t("div",{staticClass:"text-subtitle-1 mb-4"},[s._v("Change Password")]),t(w.A,{staticClass:"mb-2",attrs:{label:"Current Password","append-icon":s.showCurrentPassword?"mdi-eye":"mdi-eye-off",type:s.showCurrentPassword?"text":"password",rules:[s=>!this.passwordData.newPassword||(!!s||"Current password is required")],outlined:"",dense:""},on:{"click:append":function(t){s.showCurrentPassword=!s.showCurrentPassword}},model:{value:s.passwordData.currentPassword,callback:function(t){s.$set(s.passwordData,"currentPassword",t)},expression:"passwordData.currentPassword"}}),t(w.A,{staticClass:"mb-2",attrs:{label:"New Password","append-icon":s.showNewPassword?"mdi-eye":"mdi-eye-off",type:s.showNewPassword?"text":"password",rules:[s=>!this.passwordData.currentPassword||(!!s||"New password is required"),...s.passwordRules],outlined:"",dense:""},on:{"click:append":function(t){s.showNewPassword=!s.showNewPassword}},model:{value:s.passwordData.newPassword,callback:function(t){s.$set(s.passwordData,"newPassword",t)},expression:"passwordData.newPassword"}}),t(w.A,{attrs:{label:"Confirm New Password","append-icon":s.showConfirmPassword?"mdi-eye":"mdi-eye-off",type:s.showConfirmPassword?"text":"password",rules:[s=>!this.passwordData.newPassword||(!!s||"Please confirm your password"),s=>!this.passwordData.newPassword||(s===this.passwordData.newPassword||"Passwords do not match")],outlined:"",dense:""},on:{"click:append":function(t){s.showConfirmPassword=!s.showConfirmPassword}},model:{value:s.passwordData.confirmPassword,callback:function(t){s.$set(s.passwordData,"confirmPassword",t)},expression:"passwordData.confirmPassword"}})],1)],1)],1)],1),t(d.A),t(i.SL,{staticClass:"pa-4"},[t(u.A),t(e.A,{attrs:{color:"primary",disabled:!s.valid,loading:s.loading,"min-width":"120"},on:{click:s.updateProfile}},[s._v(" Save Changes ")])],1)],1),t(h.A,{attrs:{color:s.snackbar.color,timeout:"3000"},scopedSlots:s._u([{key:"action",fn:function({attrs:a}){return[t(e.A,s._b({attrs:{text:""},on:{click:function(t){s.snackbar.show=!1}}},"v-btn",a,!1),[s._v(" Close ")])]}}]),model:{value:s.snackbar.show,callback:function(t){s.$set(s.snackbar,"show",t)},expression:"snackbar.show"}},[s._v(" "+s._s(s.snackbar.text)+" ")])],1)},m=[],f=a(5353),v={name:"UserProfile",data:()=>({valid:!1,loading:!1,showCurrentPassword:!1,showNewPassword:!1,showConfirmPassword:!1,formData:{email:"",username:"",roles:""},passwordData:{currentPassword:"",newPassword:"",confirmPassword:""},snackbar:{show:!1,text:"",color:"success"},emailRules:[s=>!!s||"E-mail is required",s=>/.+@.+\..+/.test(s)||"E-mail must be valid"],passwordRules:[s=>!s||s.length>=8||"Password must be at least 8 characters"]}),mounted(){this.fetchUserData()},methods:{...(0,f.i0)("users",["getUser","updateUser"]),async fetchUserData(){const s=JSON.parse(localStorage.getItem("user"));try{const t=await this.getUser(s._id),{email:a,username:e,roles:r}=t;this.formData={email:a,username:e,roles:r}}catch(t){this.showSnackbar("Error fetching user data","error"),console.error("Error fetching user data:",t)}},async updateProfile(){if(!this.$refs.form.validate())return;const s=JSON.parse(localStorage.getItem("user"));this.loading=!0;try{const t={email:this.formData.email,username:this.formData.username};if(this.passwordData.currentPassword&&this.passwordData.newPassword){if(this.passwordData.newPassword!==this.passwordData.confirmPassword)return void this.showSnackbar("Passwords do not match","error");t.currentPassword=this.passwordData.currentPassword,t.newPassword=this.passwordData.newPassword}else if(this.passwordData.currentPassword||this.passwordData.newPassword)return void this.showSnackbar("Both current and new password are required to change password","error");const a=await this.updateUser({id:s._id,userData:t});this.showSnackbar("Profile updated successfully","success"),this.$emit("profile-updated",a.data),this.passwordData.currentPassword="",this.passwordData.newPassword="",this.passwordData.confirmPassword=""}catch(t){this.showSnackbar(t.response?.data?.message||"Error updating profile","error"),console.error("Error updating profile:",t)}finally{this.loading=!1}},showSnackbar(s,t="success"){this.snackbar.text=s,this.snackbar.color=t,this.snackbar.show=!0}}},g=v,b=a(1656),P=(0,b.A)(g,p,m,!1,null,"0fab60ab",null),k=P.exports},9483:function(s,t,a){a.d(t,{A:function(){return r}});var e=a(3381),r=e.A.extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render(s){let t;return this.$attrs.role&&"separator"!==this.$attrs.role||(t=this.vertical?"vertical":"horizontal"),s("hr",{class:{"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical,...this.themeClasses},attrs:{role:"separator","aria-orientation":t,...this.$attrs},on:this.$listeners})}})},174:function(s,t,a){a(4114);var e=a(5803),r=a(7717),i=a(7540),o=a(4152);t.A=(0,e.A)(r.A,(0,i.G)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(s){const t=Object.values(s).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(s){const t=s=>s.$watch("hasError",(t=>{this.$set(this.errorBag,s._uid,t)}),{immediate:!0}),a={_uid:s._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=s.$watch("shouldValidate",(e=>{e&&(this.errorBag.hasOwnProperty(s._uid)||(a.valid=t(s)))})):a.valid=t(s),a},validate(){return 0===this.inputs.filter((s=>!s.validate(!0))).length},reset(){this.inputs.forEach((s=>s.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((s=>s.resetValidation())),this.resetErrorBag()},register(s){this.inputs.push(s),this.watchers.push(this.watchInput(s))},unregister(s){const t=this.inputs.find((t=>t._uid===s._uid));if(!t)return;const a=this.watchers.find((s=>s._uid===t._uid));a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter((s=>s._uid!==t._uid)),this.inputs=this.inputs.filter((s=>s._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}},render(s){return s("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:s=>this.$emit("submit",s)}},(0,o.$c)(this))}})},1034:function(s,t,a){a(158);var e=a(4152);t.A=(0,e.Gn)("spacer","div","v-spacer")},7150:function(s,t,a){a.d(t,{A:function(){return h}});var e=a(8184),r=a(8743),i=a(3381),o=a(428),n=a(6763),d=a(5803),l=a(4152),c=a(6988),h=(0,d.A)(e.A,r.A,o.A,(0,n.P)(["absolute","bottom","left","right","top"])).extend({name:"v-snackbar",props:{app:Boolean,centered:Boolean,contentClass:{type:String,default:""},multiLine:Boolean,text:Boolean,timeout:{type:[Number,String],default:5e3},transition:{type:[Boolean,String],default:"v-snack-transition",validator:s=>"string"===typeof s||!1===s},vertical:Boolean},data:()=>({activeTimeout:-1}),computed:{classes(){return{"v-snack--absolute":this.absolute,"v-snack--active":this.isActive,"v-snack--bottom":this.bottom||!this.top,"v-snack--centered":this.centered,"v-snack--has-background":this.hasBackground,"v-snack--left":this.left,"v-snack--multi-line":this.multiLine&&!this.vertical,"v-snack--right":this.right,"v-snack--text":this.text,"v-snack--top":this.top,"v-snack--vertical":this.vertical}},hasBackground(){return!this.text&&!this.outlined},isDark(){return this.hasBackground?!this.light:i.A.options.computed.isDark.call(this)},styles(){if(this.absolute||!this.app)return{};const{bar:s,bottom:t,footer:a,insetFooter:e,left:r,right:i,top:o}=this.$vuetify.application;return{paddingBottom:(0,l.Dg)(t+a+e),paddingLeft:(0,l.Dg)(r),paddingRight:(0,l.Dg)(i),paddingTop:(0,l.Dg)(s+o)}}},watch:{isActive:"setTimeout",timeout:"setTimeout"},mounted(){this.isActive&&this.setTimeout()},created(){this.$attrs.hasOwnProperty("auto-height")&&(0,c.rq)("auto-height",this),0==this.timeout&&(0,c.CI)('timeout="0"',"-1",this)},methods:{genActions(){return this.$createElement("div",{staticClass:"v-snack__action "},[(0,l.$c)(this,"action",{attrs:{class:"v-snack__btn"}})])},genContent(){return this.$createElement("div",{staticClass:"v-snack__content",class:{[this.contentClass]:!0},attrs:{role:"status","aria-live":"polite"}},[(0,l.$c)(this)])},genWrapper(){const s=this.hasBackground?this.setBackgroundColor:this.setTextColor,t=s(this.color,{staticClass:"v-snack__wrapper",class:e.A.options.computed.classes.call(this),style:e.A.options.computed.styles.call(this),directives:[{name:"show",value:this.isActive}],on:{pointerenter:()=>window.clearTimeout(this.activeTimeout),pointerleave:this.setTimeout}});return this.$createElement("div",t,[this.genContent(),this.genActions()])},genTransition(){return this.$createElement("transition",{props:{name:this.transition}},[this.genWrapper()])},setTimeout(){window.clearTimeout(this.activeTimeout);const s=Number(this.timeout);this.isActive&&![0,-1].includes(s)&&(this.activeTimeout=window.setTimeout((()=>{this.isActive=!1}),s))}},render(s){return s("div",{staticClass:"v-snack",class:this.classes,style:this.styles},[!1!==this.transition?this.genTransition():this.genWrapper()])}})}}]);
//# sourceMappingURL=284.a6c931e9.js.map