(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[618],{8898:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return k}});var a=s(1965),o=s(3740),r=s(3698),i=s(2938),n=s(3180),l=s(4414),c=s(3449),d=s(3064),u=s(9483),m=s(6930),h=s(2756),p=s(5834),v=s(5961),g=s(1034),f=function(){var t=this,e=t._self._c;return e(c.A,{attrs:{fluid:""}},[e(r.A,{staticClass:"mb-6 header-card",attrs:{elevation:"2"}},[e(h.A,{staticClass:"pa-6",attrs:{"no-gutters":"",align:"center"}},[e(l.A,{attrs:{cols:"12",sm:"4"}},[e("div",{staticClass:"header-title"},[e("h2",{staticClass:"white--text"},[t._v("Academic Reports Dashboard")]),e("span",{staticClass:"subtitle-1 grey--text text--lighten-2"},[t._v(" Analytics and Statistics ")])])]),e(l.A,{attrs:{cols:"12",sm:"8"}},[e(h.A,{attrs:{align:"center",justify:"end"}},[e(l.A,{attrs:{cols:"auto"}},[e(p.A,{staticClass:"filter-select",attrs:{items:t.academicYears,label:"Academic Year",dense:"",outlined:"","hide-details":"","background-color":"white"},model:{value:t.selectedAcademicYear,callback:function(e){t.selectedAcademicYear=e},expression:"selectedAcademicYear"}})],1),e(l.A,{attrs:{cols:"auto"}},[e(p.A,{staticClass:"filter-select",attrs:{items:t.semesters,label:"Semester",dense:"",outlined:"","hide-details":"","background-color":"white"},model:{value:t.selectedSemester,callback:function(e){t.selectedSemester=e},expression:"selectedSemester"}})],1),e(l.A,{attrs:{cols:"auto"}},[e(o.A,{attrs:{color:"white",loading:t.loading,elevation:"2"},on:{click:t.generateReports}},[e(m.A,{attrs:{left:""}},[t._v("mdi-sync")]),t._v(" Generate Reports ")],1)],1)],1)],1)],1)],1),e(v.QG,[t.error?e(a.A,{staticClass:"mb-4",attrs:{type:"error",dismissible:"",elevation:"2"},on:{input:t.clearError}},[t._v(" "+t._s(t.error)+" ")]):t._e()],1),e(h.A,[e(l.A,{attrs:{cols:"12",sm:"6",md:"3"}},[e(r.A,{staticClass:"summary-card primary",attrs:{elevation:"2"}},[e(i.OQ,[e("div",{staticClass:"summary-content"},[e("div",{staticClass:"summary-icon"},[e(m.A,{attrs:{"x-large":"",color:"white"}},[t._v("mdi-account-group")])],1),e("div",{staticClass:"summary-data"},[e("div",{staticClass:"text-h4 white--text"},[t._v(t._s(t.getTotalStudents))]),e("div",{staticClass:"subtitle-2 white--text"},[t._v("Total Students")])])])])],1)],1),e(l.A,{attrs:{cols:"12",sm:"6",md:"3"}},[e(r.A,{staticClass:"summary-card success",attrs:{elevation:"2"}},[e(i.OQ,[e("div",{staticClass:"summary-content"},[e("div",{staticClass:"summary-icon"},[e(m.A,{attrs:{"x-large":"",color:"white"}},[t._v("mdi-account")])],1),e("div",{staticClass:"summary-data"},[e("div",{staticClass:"text-h4 white--text"},[t._v(t._s(t.getTotalTeachers))]),e("div",{staticClass:"subtitle-2 white--text"},[t._v("Active Faculty")])])])])],1)],1),e(l.A,{attrs:{cols:"12",sm:"6",md:"3"}},[e(r.A,{staticClass:"summary-card warning",attrs:{elevation:"2"}},[e(i.OQ,[e("div",{staticClass:"summary-content"},[e("div",{staticClass:"summary-icon"},[e(m.A,{attrs:{"x-large":"",color:"white"}},[t._v("mdi-book-open-variant")])],1),e("div",{staticClass:"summary-data"},[e("div",{staticClass:"text-h4 white--text"},[t._v(t._s(t.getTotalSubjects))]),e("div",{staticClass:"subtitle-2 white--text"},[t._v("Active Subjects")])])])])],1)],1),e(l.A,{attrs:{cols:"12",sm:"6",md:"3"}},[e(r.A,{staticClass:"summary-card info",attrs:{elevation:"2"}},[e(i.OQ,[e("div",{staticClass:"summary-content"},[e("div",{staticClass:"summary-icon"},[e(m.A,{attrs:{"x-large":"",color:"white"}},[t._v("mdi-office-building")])],1),e("div",{staticClass:"summary-data"},[e("div",{staticClass:"text-h4 white--text"},[t._v(" "+t._s(t.departmentFaculty.length)+" ")]),e("div",{staticClass:"subtitle-2 white--text"},[t._v("Departments")])])])])],1)],1)],1),e(h.A,{staticClass:"mt-6"},[e(l.A,{attrs:{cols:"12",md:"6"}},[e(r.A,{staticClass:"report-card",attrs:{height:"100%",elevation:"2"}},[e(i.ri,{staticClass:"report-title"},[e(m.A,{attrs:{left:"",color:"primary"}},[t._v("mdi-chart-bar")]),t._v(" Enrollment Statistics "),e(g.A),e(o.A,{attrs:{icon:"",loading:t.downloading.enrollment},on:{click:function(e){return t.downloadReport("enrollment")}}},[e(m.A,[t._v("mdi-download")])],1)],1),e(u.A),e(i.OQ,{staticClass:"pa-4"},[e(d.A,{staticClass:"elevation-1",attrs:{headers:t.enrollmentHeaders,items:t.enrollmentStats,"items-per-page":5,dense:"",loading:t.loading,"loading-text":"Loading enrollment data..."},scopedSlots:t._u([{key:"item.count",fn:function({item:s}){return[e(n.A,{attrs:{color:t.getStatusColor(s._id.enrollmentStatus),small:"",label:""}},[t._v(" "+t._s(s.count)+" ")])]}}])})],1)],1)],1),e(l.A,{attrs:{cols:"12",md:"6"}},[e(r.A,{staticClass:"report-card",attrs:{height:"100%",elevation:"2"}},[e(i.ri,{staticClass:"report-title"},[e(m.A,{attrs:{left:"",color:"success"}},[t._v("mdi-account-tie")]),t._v(" Teacher Loads "),e(g.A),e(o.A,{attrs:{icon:"",loading:t.downloading.teacherLoads},on:{click:function(e){return t.downloadReport("teacherLoads")}}},[e(m.A,[t._v("mdi-download")])],1)],1),e(u.A),e(i.OQ,{staticClass:"pa-4"},[e(d.A,{staticClass:"elevation-1",attrs:{headers:t.teacherLoadHeaders,items:t.teacherLoads,"items-per-page":5,dense:"",loading:t.loading,"loading-text":"Loading teacher loads..."},scopedSlots:t._u([{key:"item.totalUnits",fn:function({item:s}){return[e(n.A,{attrs:{color:t.getUnitLoadColor(s.totalUnits),small:"",label:""}},[t._v(" "+t._s(s.totalUnits)+" ")])]}}])})],1)],1)],1),e(l.A,{attrs:{cols:"12",md:"6"}},[e(r.A,{staticClass:"report-card",attrs:{height:"100%",elevation:"2"}},[e(i.ri,{staticClass:"report-title"},[e(m.A,{attrs:{left:"",color:"warning"}},[t._v("mdi-book-multiple")]),t._v(" Subject Statistics "),e(g.A),e(o.A,{attrs:{icon:"",loading:t.downloading.subjects},on:{click:function(e){return t.downloadReport("subjects")}}},[e(m.A,[t._v("mdi-download")])],1)],1),e(u.A),e(i.OQ,{staticClass:"pa-4"},[e(d.A,{staticClass:"elevation-1",attrs:{headers:t.subjectStatHeaders,items:t.subjectStats,"items-per-page":5,dense:"",loading:t.loading,"loading-text":"Loading subject statistics..."},scopedSlots:t._u([{key:"item.totalStudents",fn:function({item:s}){return[e(n.A,{attrs:{color:t.getStudentCountColor(s.totalStudents),small:"",label:""}},[t._v(" "+t._s(s.totalStudents)+" ")])]}}])})],1)],1)],1),e(l.A,{attrs:{cols:"12",md:"6"}},[e(r.A,{staticClass:"report-card",attrs:{height:"100%",elevation:"2"}},[e(i.ri,{staticClass:"report-title"},[e(m.A,{attrs:{left:"",color:"info"}},[t._v("mdi-domain")]),t._v(" Department Faculty "),e(g.A),e(o.A,{attrs:{icon:"",loading:t.downloading.faculty},on:{click:function(e){return t.downloadReport("faculty")}}},[e(m.A,[t._v("mdi-download")])],1)],1),e(u.A),e(i.OQ,{staticClass:"pa-4"},[e(d.A,{staticClass:"elevation-1",attrs:{headers:t.departmentFacultyHeaders,items:t.departmentFaculty,"items-per-page":5,dense:"",loading:t.loading,"loading-text":"Loading department data..."},scopedSlots:t._u([{key:"item.totalFaculty",fn:function({item:s}){return[e(n.A,{attrs:{color:t.getFacultyCountColor(s.totalFaculty),small:"",label:""}},[t._v(" "+t._s(s.totalFaculty)+" ")])]}}])})],1)],1)],1)],1)],1)},A=[],b=(s(4114),s(5353)),y=s(4213),C=s(3959),_={name:"ReportsPage",data:()=>({selectedAcademicYear:"",selectedSemester:"",semesters:["First","Second"],downloading:{enrollment:!1,teacherLoads:!1,subjects:!1,faculty:!1},enrollmentHeaders:[{text:"Year Level",value:"_id.yearLevel",align:"start"},{text:"Status",value:"_id.enrollmentStatus"},{text:"Count",value:"count"}],teacherLoadHeaders:[{text:"Professor",value:"professorName",align:"start"},{text:"Total Units",value:"totalUnits"},{text:"Subjects",value:"subjectCount"},{text:"Students",value:"totalStudents"}],subjectStatHeaders:[{text:"Subject",value:"subjectName",align:"start"},{text:"Sections",value:"totalSections"},{text:"Students",value:"totalStudents"}],departmentFacultyHeaders:[{text:"Department",value:"departmentName",align:"start"},{text:"Faculty Count",value:"totalFaculty"}]}),computed:{...(0,b.aH)("reports",["loading","error"]),...(0,b.L8)("reports",["enrollmentStats","teacherLoads","subjectStats","departmentFaculty"]),getTotalStudents(){return this.enrollmentStats.reduce(((t,e)=>t+e.count),0)},getTotalTeachers(){return this.teacherLoads.length},getTotalSubjects(){return this.subjectStats.length},academicYears(){const t=2023,e=2030,s=[];for(let a=t;a<e;a++)s.push(`${a}-${a+1}`);return s}},methods:{...(0,b.i0)("reports",["fetchEnrollmentStatistics","fetchTeacherLoads","fetchSubjectStatistics","fetchDepartmentFaculty"]),clearError(){this.$store.commit("reports/CLEAR_ERROR")},getStatusColor(t){const e={pending:"warning",evaluated:"info",enrolled:"success"};return e[t]||"grey"},getUnitLoadColor(t){return t<=15?"success":t<=21?"warning":"error"},getStudentCountColor(t){return t<=30?"success":t<=40?"warning":"error"},getFacultyCountColor(t){return t<=5?"error":t<=10?"warning":"success"},async generateReports(){try{const t={academicYear:this.selectedAcademicYear,semester:this.selectedSemester};await Promise.all([this.fetchEnrollmentStatistics(t),this.fetchTeacherLoads(t),this.fetchSubjectStatistics(t),this.fetchDepartmentFaculty()])}catch(t){console.error("Error generating reports:",t)}},async downloadReport(t){this.downloading[t]=!0;try{let e,s;switch(t){case"enrollment":e=this.enrollmentStats,s="enrollment-statistics";break;case"teacherLoads":e=this.teacherLoads,s="teacher-loads";break;case"subjects":e=this.subjectStats,s="subject-statistics";break;case"faculty":e=this.departmentFaculty,s="department-faculty";break}const a=C.Wp.book_new(),o=C.Wp.json_to_sheet(e);C.Wp.book_append_sheet(a,o,"Report");const r=C.M9(a,{bookType:"xlsx",type:"array"}),i=new Blob([r],{type:"application/octet-stream"});(0,y.saveAs)(i,`${s}-${this.selectedAcademicYear}-${this.selectedSemester}.xlsx`)}catch(e){console.error(`Error downloading ${t} report:`,e),this.$store.commit("SET_ERROR",`Failed to download ${t} report`)}finally{this.downloading[t]=!1}}},created(){this.selectedAcademicYear=this.academicYears[0],this.selectedSemester=this.semesters[0],this.generateReports()}},w=_,S=s(1656),x=(0,S.A)(w,f,A,!1,null,"0d06bd9a",null),k=x.exports},1965:function(t,e,s){"use strict";s.d(e,{A:function(){return h}});var a=s(9375),o=s(4728),r=s(569),i=s(428),n=s(3381),l=s(5471),c=l.Ay.extend({name:"transitionable",props:{mode:String,origin:String,transition:String}}),d=s(5803),u=s(6988),m=s(4152),h=(0,d.A)(a.A,i.A,c).extend({name:"v-alert",props:{border:{type:String,validator(t){return["top","right","bottom","left"].includes(t)}},closeLabel:{type:String,default:"$vuetify.close"},coloredBorder:Boolean,dense:Boolean,dismissible:Boolean,closeIcon:{type:String,default:"$cancel"},icon:{default:"",type:[Boolean,String],validator(t){return"string"===typeof t||!1===t}},outlined:Boolean,prominent:Boolean,text:Boolean,type:{type:String,validator(t){return["info","error","success","warning"].includes(t)}},value:{type:Boolean,default:!0}},computed:{__cachedBorder(){if(!this.border)return null;let t={staticClass:"v-alert__border",class:{[`v-alert__border--${this.border}`]:!0}};return this.coloredBorder&&(t=this.setBackgroundColor(this.computedColor,t),t.class["v-alert__border--has-color"]=!0),this.$createElement("div",t)},__cachedDismissible(){if(!this.dismissible)return null;const t=this.iconColor;return this.$createElement(o.A,{staticClass:"v-alert__dismissible",props:{color:t,icon:!0,small:!0},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:()=>this.isActive=!1}},[this.$createElement(r.A,{props:{color:t}},this.closeIcon)])},__cachedIcon(){return this.computedIcon?this.$createElement(r.A,{staticClass:"v-alert__icon",props:{color:this.iconColor}},this.computedIcon):null},classes(){const t={...a.A.options.computed.classes.call(this),"v-alert--border":Boolean(this.border),"v-alert--dense":this.dense,"v-alert--outlined":this.outlined,"v-alert--prominent":this.prominent,"v-alert--text":this.text};return this.border&&(t[`v-alert--border-${this.border}`]=!0),t},computedColor(){return this.color||this.type},computedIcon(){return!1!==this.icon&&("string"===typeof this.icon&&this.icon?this.icon:!!["error","info","success","warning"].includes(this.type)&&`$${this.type}`)},hasColoredIcon(){return this.hasText||Boolean(this.border)&&this.coloredBorder},hasText(){return this.text||this.outlined},iconColor(){return this.hasColoredIcon?this.computedColor:void 0},isDark(){return!(!this.type||this.coloredBorder||this.outlined)||n.A.options.computed.isDark.call(this)}},created(){this.$attrs.hasOwnProperty("outline")&&(0,u.q4)("outline","outlined",this)},methods:{genWrapper(){const t=[(0,m.$c)(this,"prepend")||this.__cachedIcon,this.genContent(),this.__cachedBorder,(0,m.$c)(this,"append"),this.$scopedSlots.close?this.$scopedSlots.close({toggle:this.toggle}):this.__cachedDismissible],e={staticClass:"v-alert__wrapper"};return this.$createElement("div",e,t)},genContent(){return this.$createElement("div",{staticClass:"v-alert__content"},(0,m.$c)(this))},genAlert(){let t={staticClass:"v-alert",attrs:{role:"alert"},on:this.listeners$,class:this.classes,style:this.styles,directives:[{name:"show",value:this.isActive}]};if(!this.coloredBorder){const e=this.hasText?this.setTextColor:this.setBackgroundColor;t=e(this.computedColor,t)}return this.$createElement("div",t,[this.genWrapper()])},toggle(){this.isActive=!this.isActive}},render(t){const e=this.genAlert();return this.transition?t("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[e]):e}})},4213:function(t,e,s){var a,o,r;(function(s,i){o=[],a=i,r="function"===typeof a?a.apply(e,o):a,void 0===r||(t.exports=r)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function a(t,e,s){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){l(a.response,e,s)},a.onerror=function(){console.error("could not download file")},a.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(a){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof s.g&&s.g.global===s.g?s.g:void 0,n=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(t,e,s){var n=i.URL||i.webkitURL,l=document.createElement("a");e=e||t.name||"download",l.download=e,l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?r(l):o(l.href)?a(t,e,s):r(l,l.target="_blank")):(l.href=n.createObjectURL(t),setTimeout((function(){n.revokeObjectURL(l.href)}),4e4),setTimeout((function(){r(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,s,i){if(s=s||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,i),s);else if(o(t))a(t,s,i);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout((function(){r(n)}))}}:function(t,e,s,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return a(t,e,s);var r="application/octet-stream"===t.type,l=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&l||n)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var t=d.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},d.readAsDataURL(t)}else{var u=i.URL||i.webkitURL,m=u.createObjectURL(t);o?o.location=m:location.href=m,o=null,setTimeout((function(){u.revokeObjectURL(m)}),4e4)}});i.saveAs=l.saveAs=l,t.exports=l}))}}]);
//# sourceMappingURL=618.afdf1c8b.js.map